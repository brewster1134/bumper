// Generated by CoffeeScript 1.7.1

/*
 * * bumper | responsive | image
 * * https://github.com/brewster1134/bumper
 * *
 * * @version 1.0.2
 * * @author Ryan Brewster
 * * Copyright (c) 2014
 * * Licensed under the MIT license.
 */

(function() {
  var __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  (function(root, factory) {
    if (typeof define === 'function' && define.amd) {
      return define(['jquery', 'bumper-core'], function($, BumperCore) {
        return factory($, BumperCore);
      });
    } else {
      return root.Bumper.Responsive.Image = factory(jQuery, root.Bumper.Core);
    }
  })(this, function($, BumperCore) {
    var BumperResponsiveImage;
    BumperResponsiveImage = (function(_super) {
      __extends(BumperResponsiveImage, _super);

      function BumperResponsiveImage() {
        return BumperResponsiveImage.__super__.constructor.apply(this, arguments);
      }

      BumperResponsiveImage.prototype.resize = function($img, breakpoint) {
        var bpParams, defaultParams, params, src, url;
        url = $img.attr("data-bumper-responsive-image-url-" + breakpoint) || $img.attr('data-bumper-responsive-image-url');
        if (!url) {
          console.warn("data-bumper-responsive-image-url[-" + breakpoint + "] is not set.", $img);
          return;
        }
        defaultParams = $img.attr('data-bumper-responsive-image-url-params');
        bpParams = $img.attr("data-bumper-responsive-image-url-params-" + breakpoint);
        params = this.combineParams(defaultParams, bpParams);
        src = this.interpolateElementAttrs("" + url + params, $img);
        $img.load(function() {
          return $img.trigger('bumper.responsive.image.loaded');
        });
        $img.attr('data-bumper-breakpoint', breakpoint);
        return $img.attr('src', src);
      };

      BumperResponsiveImage.prototype.resizeAll = function(breakpoint) {
        var _this;
        _this = this;
        return $('.bumper-responsive-image').each(function() {
          return _this.resize($(this), breakpoint);
        });
      };

      return BumperResponsiveImage;

    })(BumperCore);
    return new BumperResponsiveImage;
  });

}).call(this);
