// Generated by CoffeeScript 1.7.1

/*
 * * bumper | responsive | images
 * * https://github.com/brewster1134/bumper
 * *
 * * @version 0.0.1
 * * @author Ryan Brewster
 * * Copyright (c) 2014
 * * Licensed under the MIT license.
 */

(function() {
  (function(root, factory) {
    if (typeof define === 'function' && define.amd) {
      return define(['jquery', 'bumper-core'], function($) {
        return factory($);
      });
    } else {
      return window.Bumper.Responsive.Image = factory(jQuery);
    }
  })(this, function($) {
    return {
      resize: function($img, breakpoint) {
        var bpParams, defaultParams, params, url;
        url = $img.attr("data-bumper-responsive-image-url-" + breakpoint) || $img.attr('data-bumper-responsive-image-url');
        if (!url) {
          console.warn("data-bumper-responsive-image-url[-" + breakpoint + "] is not set.", $img);
          return;
        }
        defaultParams = $img.attr('data-bumper-responsive-image-url-params');
        bpParams = $img.attr("data-bumper-responsive-image-url-params-" + breakpoint);
        params = [defaultParams, bpParams].filter(function(n) {
          return n !== void 0 && n !== null && n !== '';
        });
        params = params.length ? "?" + (params.join('&')) : '';
        $img.load(function() {
          return $img.trigger('bumper.responsive.image.loaded');
        });
        $img.attr('data-bumper-breakpoint', breakpoint);
        return $img.attr('src', "" + url + params);
      },
      resizeAll: function(breakpoint) {
        var _this;
        _this = this;
        return $('.bumper-responsive-image').each(function() {
          return _this.resize($(this), breakpoint);
        });
      }
    };
  });

}).call(this);
